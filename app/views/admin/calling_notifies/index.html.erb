<div class="container nogap ">
  <% @table_numbers.each do |table_number| %>
    <a href="javascript:;">
      <div class="box-w8">
        <div class="admin-box text-center table-number <%= table_number.status == 'used' ? "used main-bg-color" : "unuse beige-bg-color" %>" data-number="<%= table_number.number %>" style="margin-bottom:15px;">
          <span><%= table_number.number %>桌</span>
        </div>
      </div>
    </a>
  <% end %>
</div>
<br />

<div class="container  mod-inner">
  <%= render partial: 'calling_notifies', locals: { calling_notifies: @calling_notifies } %>
  <%= paginate @calling_notifies %>
</div>


<!-- required: realtime support framework -->
<%= realtime_support %>
<script type="text/javascript" charset="utf-8">

if (window.realtime.enabled && window.realtime.eventBus){
  // handle events in the queue with eventing
  var realtimeMessageEventConsoleLogger = function(message) {
    console.log(message);
  };
  window.realtime.eventBus.on('realtimeMessage', realtimeMessageEventConsoleLogger);

} else if (window.realtime.enabled) {
  // handle events in the queue without eventing
  messageQueueConsoleLogger = function() {
    message = window.realtime.messageQueue.shift();
    if (message) {
      $('#realtime-modal .modal-body').html(message.msg.text);
      $('#realtime-modal .modal-title').html(message.msg.title);
      $('#realtime-modal').modal();
    }
  };
  setInterval(messageQueueConsoleLogger, 100);

} else {
  console.log('Error: Realtime was not enabled.')
}

$(function() {
  if($('#realtime-modal').hasClass('notice')){
    $('#realtime-modal .modal-title').html('服务通知');
    $('#realtime-modal').modal();
  }
})

</script>

<!-- Modal -->
<div class="modal fade <%= "notice" if @notice.present? %>" id="realtime-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="realtime-lable">新服务通知</h4>
      </div>
      <div class="modal-body"><%== @notice %></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>
